package com.udb.modulo2.clase07.services;

import android.app.IntentService;
import android.content.Intent;
import android.util.Log;

public class CountService extends IntentService {
	
	private final String tagintent = "com.udb.modulo2.clase07.services.CountService";
	public static final String namebitmap = "com.udb.modulo2.clase07.services.CountService.BITMAP";
	String url = "";
	
	public CountService() {
		super("CountService");
		Log.d(tagintent, "Servicio CountService Iniciado");
	}

	@Override
	protected void onHandleIntent(Intent arg0) {
		try {
       	 url = intent.getStringExtra(MainActivity.URLID);
       	 Bitmap bitmap = BitmapFactory.decodeStream((InputStream)new URL(url).getContent());
       	 String extStorageDirectory = Environment.getExternalStorageDirectory().toString();
       	 OutputStream outStream = null;
       	 File file = new File(extStorageDirectory, "android.jpg");
       	 
       	 outStream = new FileOutputStream(file);
            bitmap.compress(Bitmap.CompressFormat.JPEG, 100, outStream);
            outStream.flush();
            outStream.close();
    		
            Log.d(tagintent, "Finalizo proceos CountService");
         } catch (Exception e) {
       	  Log.d(tagintent, "Error: "+e.getMessage());
         }
	}

}
